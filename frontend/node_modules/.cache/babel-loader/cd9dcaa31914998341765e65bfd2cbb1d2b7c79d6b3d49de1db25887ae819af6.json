{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ollie\\\\OneDrive\\\\Documents\\\\personal-Projects\\\\Mamils\\\\frontend\\\\src\\\\components\\\\MapView.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useMemo } from \"react\";\nimport { MapContainer, TileLayer, Marker, Popup } from \"react-leaflet\";\nimport L from \"leaflet\";\nimport { FiCalendar, FiMapPin, FiMountain, FiRoute, FiImage } from \"react-icons/fi\";\nimport usePhotos from \"../hooks/usePhotos\";\n\n// Leaflet icon fix\nimport markerIcon2x from \"leaflet/dist/images/marker-icon-2x.png\";\nimport markerIcon from \"leaflet/dist/images/marker-icon.png\";\nimport markerShadow from \"leaflet/dist/images/marker-shadow.png\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: markerIcon2x,\n  iconUrl: markerIcon,\n  shadowUrl: markerShadow\n});\n\n// Create custom bike icon\nconst createBikeIcon = (count = 1, isCluster = false) => {\n  const size = isCluster ? 50 : 40;\n  const color = isCluster ? \"#2563eb\" : \"#059669\";\n  const textColor = \"white\";\n  return L.divIcon({\n    html: `\n      <div style=\"\n        width: ${size}px;\n        height: ${size}px;\n        background: ${color};\n        border: 3px solid white;\n        border-radius: 50%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        color: ${textColor};\n        font-weight: bold;\n        font-size: ${isCluster ? \"14px\" : \"12px\"};\n        position: relative;\n      \">\n        ${isCluster ? count : 'ðŸš´'}\n        ${isCluster ? \"\" : `<div style=\"\n              position: absolute;\n              bottom: -8px;\n              left: 50%;\n              transform: translateX(-50%);\n              width: 0;\n              height: 0;\n              border-left: 6px solid transparent;\n              border-right: 6px solid transparent;\n              border-top: 8px solid ${color};\n            \"></div>`}\n      </div>\n    `,\n    className: \"custom-bike-marker\",\n    iconSize: [size, size],\n    iconAnchor: [size / 2, isCluster ? size / 2 : size + 8],\n    popupAnchor: [0, isCluster ? -size / 2 : -size - 8]\n  });\n};\n\n// Ride Popup Component\nconst RidePopup = ({\n  rides\n}) => {\n  _s();\n  const {\n    getPhotosByIds,\n    getPhotoUrl\n  } = usePhotos();\n  const formatDate = dateStr => new Date(dateStr).toLocaleDateString(\"en-US\", {\n    year: \"numeric\",\n    month: \"long\",\n    day: \"numeric\"\n  });\n  if (!rides || rides.length === 0) return null;\n  const renderSingleRide = ride => {\n    const photos = getPhotosByIds(ride.photos || []);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-3 max-w-sm\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-bold text-lg text-gray-900\",\n          children: ride.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this), ride.locationName && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-600 flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(FiMapPin, {\n            className: \"mr-1 text-gray-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 15\n          }, this), ride.locationName]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 gap-3 mb-3 text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(InfoItem, {\n          icon: /*#__PURE__*/_jsxDEV(FiCalendar, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 27\n          }, this),\n          label: \"Date\",\n          value: formatDate(ride.date)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(InfoItem, {\n          icon: /*#__PURE__*/_jsxDEV(FiRoute, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 27\n          }, this),\n          label: \"Distance\",\n          value: `${ride.distance} km`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(InfoItem, {\n          icon: /*#__PURE__*/_jsxDEV(FiMountain, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 27\n          }, this),\n          label: \"Elevation\",\n          value: `${ride.elevation} m`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this), photos.length > 0 && /*#__PURE__*/_jsxDEV(InfoItem, {\n          icon: /*#__PURE__*/_jsxDEV(FiImage, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 21\n          }, this),\n          label: \"Photos\",\n          value: `${photos.length} photo${photos.length !== 1 ? \"s\" : \"\"}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), ride.notes && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"font-medium text-sm mb-1\",\n          children: \"Notes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-600 bg-gray-50 p-2 rounded\",\n          children: ride.notes\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }, this), photos.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"font-medium text-sm mb-2 flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(FiImage, {\n            className: \"mr-1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 15\n          }, this), \" Photos\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-3 gap-1 max-h-32 overflow-y-auto\",\n          children: photos.slice(0, 9).map((photo, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative aspect-square\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: getPhotoUrl(photo.id),\n              alt: photo.description || `Ride photo ${i + 1}`,\n              className: \"w-full h-full object-cover rounded border\",\n              onError: e => e.target.style.display = \"none\",\n              title: photo.description || photo.originalName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 19\n            }, this), i === 8 && photos.length > 9 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center rounded\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-white text-xs font-semibold\",\n                children: [\"+\", photos.length - 9]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 21\n            }, this)]\n          }, photo.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-gray-500 mt-2 pt-2 border-t\",\n        children: \"Click and drag to explore the map\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this);\n  };\n  const renderMultipleRides = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-3 max-w-sm\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"font-bold text-lg text-gray-900 mb-2\",\n      children: [rides.length, \" Rides at this Location\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }, this), rides[0].locationName && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-sm text-gray-600 flex items-center mb-2\",\n      children: [/*#__PURE__*/_jsxDEV(FiMapPin, {\n        className: \"mr-1 text-gray-400\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 11\n      }, this), rides[0].locationName]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-3 max-h-64 overflow-y-auto\",\n      children: rides.map(ride => {\n        const photos = getPhotosByIds(ride.photos || []);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"border-l-4 border-blue-500 pl-3 bg-gray-50 p-2 rounded-r\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between items-start mb-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"font-semibold text-sm text-gray-900\",\n              children: ride.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs text-gray-500\",\n              children: formatDate(ride.date)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-wrap gap-2 text-xs text-gray-600 mb-1\",\n            children: [/*#__PURE__*/_jsxDEV(InfoSmall, {\n              icon: /*#__PURE__*/_jsxDEV(FiRoute, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 34\n              }, this),\n              value: `${ride.distance} km`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(InfoSmall, {\n              icon: /*#__PURE__*/_jsxDEV(FiMountain, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 175,\n                columnNumber: 34\n              }, this),\n              value: `${ride.elevation} m`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 17\n            }, this), photos.length > 0 && /*#__PURE__*/_jsxDEV(InfoSmall, {\n              icon: /*#__PURE__*/_jsxDEV(FiImage, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 176,\n                columnNumber: 56\n              }, this),\n              value: `${photos.length}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 39\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 15\n          }, this), ride.notes && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-600 truncate\",\n            children: ride.notes\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 30\n          }, this)]\n        }, ride.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 154,\n    columnNumber: 5\n  }, this);\n  return rides.length === 1 ? renderSingleRide(rides[0]) : renderMultipleRides();\n};\n\n// Reusable UI components\n_s(RidePopup, \"oMhWkGE2K0Ua0eyO/xw3zekrX7w=\", false, function () {\n  return [usePhotos];\n});\n_c = RidePopup;\nconst InfoItem = ({\n  icon,\n  label,\n  value\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  className: \"flex items-center\",\n  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n    className: \"mr-2 text-blue-500\",\n    children: icon\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 192,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"font-medium\",\n      children: label\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-gray-600\",\n      children: value\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 193,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 191,\n  columnNumber: 3\n}, this);\n_c2 = InfoItem;\nconst InfoSmall = ({\n  icon,\n  value\n}) => /*#__PURE__*/_jsxDEV(\"span\", {\n  className: \"flex items-center\",\n  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n    className: \"mr-1\",\n    children: icon\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 202,\n    columnNumber: 5\n  }, this), \" \", value]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 201,\n  columnNumber: 3\n}, this);\n\n// Main Map Component\n_c3 = InfoSmall;\nconst MapView = ({\n  rides\n}) => {\n  _s2();\n  const defaultPosition = [51.505, -0.09];\n  const groupedRides = useMemo(() => {\n    if (!(rides !== null && rides !== void 0 && rides.length)) return [];\n    const tolerance = 0.001;\n    const groups = [];\n    rides.forEach(ride => {\n      const match = groups.find(g => {\n        const dx = g.lat - ride.location.lat;\n        const dy = g.lng - ride.location.lng;\n        return Math.sqrt(dx * dx + dy * dy) < tolerance;\n      });\n      if (match) {\n        match.rides.push(ride);\n      } else {\n        groups.push({\n          lat: ride.location.lat,\n          lng: ride.location.lng,\n          rides: [ride]\n        });\n      }\n    });\n    return groups;\n  }, [rides]);\n  const getMapCenter = () => {\n    if (!(rides !== null && rides !== void 0 && rides.length)) return defaultPosition;\n    if (rides.length === 1) return [rides[0].location.lat, rides[0].location.lng];\n    const avgLat = rides.reduce((sum, r) => sum + r.location.lat, 0) / rides.length;\n    const avgLng = rides.reduce((sum, r) => sum + r.location.lng, 0) / rides.length;\n    return [avgLat, avgLng];\n  };\n  const getMapZoom = () => (rides === null || rides === void 0 ? void 0 : rides.length) === 1 ? 10 : 6;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"relative w-full h-full\",\n    children: [/*#__PURE__*/_jsxDEV(MapContainer, {\n      center: getMapCenter(),\n      zoom: getMapZoom(),\n      scrollWheelZoom: true,\n      className: \"w-full h-full\",\n      style: {\n        height: \"100%\",\n        width: \"100%\",\n        zIndex: 1\n      },\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 <a href=\\\"https://osm.org/copyright\\\">OpenStreetMap</a> contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this), groupedRides.map((group, i) => /*#__PURE__*/_jsxDEV(Marker, {\n        position: [group.lat, group.lng],\n        icon: createBikeIcon(group.rides.length, group.rides.length > 1),\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          maxWidth: 400,\n          className: \"custom-popup\",\n          children: /*#__PURE__*/_jsxDEV(RidePopup, {\n            rides: group.rides\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 13\n        }, this)\n      }, `group-${i}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute bottom-4 left-4 bg-white p-3 rounded-lg shadow-lg z-10 text-xs\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-semibold mb-2\",\n        children: \"Map Legend\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-1\",\n        children: [/*#__PURE__*/_jsxDEV(LegendItem, {\n          color: \"bg-green-600\",\n          label: \"Single ride\",\n          icon: \"\\uD83D\\uDEB4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(LegendItem, {\n          color: \"bg-blue-600\",\n          label: \"Multiple rides\",\n          number: \"3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 7\n    }, this), (rides === null || rides === void 0 ? void 0 : rides.length) > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute top-4 left-4 bg-white p-3 rounded-lg shadow-lg z-10 text-sm\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-semibold text-gray-900 mb-1\",\n        children: \"Your Rides\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600\",\n        children: [rides.length, \" ride\", rides.length > 1 ? \"s\" : \"\", \" \\u2022\", \" \", groupedRides.length, \" location\", groupedRides.length > 1 ? \"s\" : \"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 249,\n    columnNumber: 5\n  }, this);\n};\n_s2(MapView, \"K+M+4ggeCiIf1HHkjCqVaO2O+Us=\");\n_c4 = MapView;\nconst LegendItem = ({\n  color,\n  label,\n  icon,\n  number\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  className: \"flex items-center\",\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    className: `w-5 h-5 ${color} rounded-full mr-2 flex items-center justify-center text-white text-xs`,\n    children: icon || number\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 299,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n    children: label\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 304,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 298,\n  columnNumber: 3\n}, this);\n_c5 = LegendItem;\nexport default MapView;\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"RidePopup\");\n$RefreshReg$(_c2, \"InfoItem\");\n$RefreshReg$(_c3, \"InfoSmall\");\n$RefreshReg$(_c4, \"MapView\");\n$RefreshReg$(_c5, \"LegendItem\");","map":{"version":3,"names":["React","useMemo","MapContainer","TileLayer","Marker","Popup","L","FiCalendar","FiMapPin","FiMountain","FiRoute","FiImage","usePhotos","markerIcon2x","markerIcon","markerShadow","jsxDEV","_jsxDEV","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","createBikeIcon","count","isCluster","size","color","textColor","divIcon","html","className","iconSize","iconAnchor","popupAnchor","RidePopup","rides","_s","getPhotosByIds","getPhotoUrl","formatDate","dateStr","Date","toLocaleDateString","year","month","day","length","renderSingleRide","ride","photos","children","name","fileName","_jsxFileName","lineNumber","columnNumber","locationName","InfoItem","icon","label","value","date","distance","elevation","notes","slice","map","photo","i","src","id","alt","description","onError","e","target","style","display","title","originalName","renderMultipleRides","InfoSmall","_c","_c2","_c3","MapView","_s2","defaultPosition","groupedRides","tolerance","groups","forEach","match","find","g","dx","lat","location","dy","lng","Math","sqrt","push","getMapCenter","avgLat","reduce","sum","r","avgLng","getMapZoom","center","zoom","scrollWheelZoom","height","width","zIndex","attribution","url","group","position","maxWidth","LegendItem","number","_c4","_c5","$RefreshReg$"],"sources":["C:/Users/ollie/OneDrive/Documents/personal-Projects/Mamils/frontend/src/components/MapView.jsx"],"sourcesContent":["import React, { useMemo } from \"react\";\r\nimport { MapContainer, TileLayer, Marker, Popup } from \"react-leaflet\";\r\nimport L from \"leaflet\";\r\nimport {\r\n  FiCalendar,\r\n  FiMapPin,\r\n  FiMountain,\r\n  FiRoute,\r\n  FiImage,\r\n} from \"react-icons/fi\";\r\nimport usePhotos from \"../hooks/usePhotos\";\r\n\r\n// Leaflet icon fix\r\nimport markerIcon2x from \"leaflet/dist/images/marker-icon-2x.png\";\r\nimport markerIcon from \"leaflet/dist/images/marker-icon.png\";\r\nimport markerShadow from \"leaflet/dist/images/marker-shadow.png\";\r\n\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: markerIcon2x,\r\n  iconUrl: markerIcon,\r\n  shadowUrl: markerShadow,\r\n});\r\n\r\n// Create custom bike icon\r\nconst createBikeIcon = (count = 1, isCluster = false) => {\r\n  const size = isCluster ? 50 : 40;\r\n  const color = isCluster ? \"#2563eb\" : \"#059669\";\r\n  const textColor = \"white\";\r\n\r\n  return L.divIcon({\r\n    html: `\r\n      <div style=\"\r\n        width: ${size}px;\r\n        height: ${size}px;\r\n        background: ${color};\r\n        border: 3px solid white;\r\n        border-radius: 50%;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        color: ${textColor};\r\n        font-weight: bold;\r\n        font-size: ${isCluster ? \"14px\" : \"12px\"};\r\n        position: relative;\r\n      \">\r\n        ${isCluster ? count : 'ðŸš´'}\r\n        ${\r\n          isCluster\r\n            ? \"\"\r\n            : `<div style=\"\r\n              position: absolute;\r\n              bottom: -8px;\r\n              left: 50%;\r\n              transform: translateX(-50%);\r\n              width: 0;\r\n              height: 0;\r\n              border-left: 6px solid transparent;\r\n              border-right: 6px solid transparent;\r\n              border-top: 8px solid ${color};\r\n            \"></div>`\r\n        }\r\n      </div>\r\n    `,\r\n    className: \"custom-bike-marker\",\r\n    iconSize: [size, size],\r\n    iconAnchor: [size / 2, isCluster ? size / 2 : size + 8],\r\n    popupAnchor: [0, isCluster ? -size / 2 : -size - 8],\r\n  });\r\n};\r\n\r\n// Ride Popup Component\r\nconst RidePopup = ({ rides }) => {\r\n  const { getPhotosByIds, getPhotoUrl } = usePhotos();\r\n\r\n  const formatDate = (dateStr) =>\r\n    new Date(dateStr).toLocaleDateString(\"en-US\", {\r\n      year: \"numeric\",\r\n      month: \"long\",\r\n      day: \"numeric\",\r\n    });\r\n\r\n  if (!rides || rides.length === 0) return null;\r\n\r\n  const renderSingleRide = (ride) => {\r\n    const photos = getPhotosByIds(ride.photos || []);\r\n\r\n    return (\r\n      <div className=\"p-3 max-w-sm\">\r\n        <div className=\"mb-3\">\r\n          <h3 className=\"font-bold text-lg text-gray-900\">{ride.name}</h3>\r\n          {ride.locationName && (\r\n            <p className=\"text-sm text-gray-600 flex items-center\">\r\n              <FiMapPin className=\"mr-1 text-gray-400\" />\r\n              {ride.locationName}\r\n            </p>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-2 gap-3 mb-3 text-sm\">\r\n          <InfoItem icon={<FiCalendar />} label=\"Date\" value={formatDate(ride.date)} />\r\n          <InfoItem icon={<FiRoute />} label=\"Distance\" value={`${ride.distance} km`} />\r\n          <InfoItem icon={<FiMountain />} label=\"Elevation\" value={`${ride.elevation} m`} />\r\n          {photos.length > 0 && (\r\n            <InfoItem\r\n              icon={<FiImage />}\r\n              label=\"Photos\"\r\n              value={`${photos.length} photo${photos.length !== 1 ? \"s\" : \"\"}`}\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {ride.notes && (\r\n          <div className=\"mb-3\">\r\n            <p className=\"font-medium text-sm mb-1\">Notes</p>\r\n            <p className=\"text-sm text-gray-600 bg-gray-50 p-2 rounded\">{ride.notes}</p>\r\n          </div>\r\n        )}\r\n\r\n        {photos.length > 0 && (\r\n          <div>\r\n            <p className=\"font-medium text-sm mb-2 flex items-center\">\r\n              <FiImage className=\"mr-1\" /> Photos\r\n            </p>\r\n            <div className=\"grid grid-cols-3 gap-1 max-h-32 overflow-y-auto\">\r\n              {photos.slice(0, 9).map((photo, i) => (\r\n                <div key={photo.id} className=\"relative aspect-square\">\r\n                  <img\r\n                    src={getPhotoUrl(photo.id)}\r\n                    alt={photo.description || `Ride photo ${i + 1}`}\r\n                    className=\"w-full h-full object-cover rounded border\"\r\n                    onError={(e) => (e.target.style.display = \"none\")}\r\n                    title={photo.description || photo.originalName}\r\n                  />\r\n                  {i === 8 && photos.length > 9 && (\r\n                    <div className=\"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center rounded\">\r\n                      <span className=\"text-white text-xs font-semibold\">+{photos.length - 9}</span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"text-xs text-gray-500 mt-2 pt-2 border-t\">\r\n          Click and drag to explore the map\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderMultipleRides = () => (\r\n    <div className=\"p-3 max-w-sm\">\r\n      <h3 className=\"font-bold text-lg text-gray-900 mb-2\">\r\n        {rides.length} Rides at this Location\r\n      </h3>\r\n      {rides[0].locationName && (\r\n        <p className=\"text-sm text-gray-600 flex items-center mb-2\">\r\n          <FiMapPin className=\"mr-1 text-gray-400\" />\r\n          {rides[0].locationName}\r\n        </p>\r\n      )}\r\n      <div className=\"space-y-3 max-h-64 overflow-y-auto\">\r\n        {rides.map((ride) => {\r\n          const photos = getPhotosByIds(ride.photos || []);\r\n          return (\r\n            <div key={ride.id} className=\"border-l-4 border-blue-500 pl-3 bg-gray-50 p-2 rounded-r\">\r\n              <div className=\"flex justify-between items-start mb-1\">\r\n                <h4 className=\"font-semibold text-sm text-gray-900\">{ride.name}</h4>\r\n                <span className=\"text-xs text-gray-500\">{formatDate(ride.date)}</span>\r\n              </div>\r\n              <div className=\"flex flex-wrap gap-2 text-xs text-gray-600 mb-1\">\r\n                <InfoSmall icon={<FiRoute />} value={`${ride.distance} km`} />\r\n                <InfoSmall icon={<FiMountain />} value={`${ride.elevation} m`} />\r\n                {photos.length > 0 && <InfoSmall icon={<FiImage />} value={`${photos.length}`} />}\r\n              </div>\r\n              {ride.notes && <p className=\"text-xs text-gray-600 truncate\">{ride.notes}</p>}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return rides.length === 1 ? renderSingleRide(rides[0]) : renderMultipleRides();\r\n};\r\n\r\n// Reusable UI components\r\nconst InfoItem = ({ icon, label, value }) => (\r\n  <div className=\"flex items-center\">\r\n    <span className=\"mr-2 text-blue-500\">{icon}</span>\r\n    <div>\r\n      <p className=\"font-medium\">{label}</p>\r\n      <p className=\"text-gray-600\">{value}</p>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst InfoSmall = ({ icon, value }) => (\r\n  <span className=\"flex items-center\">\r\n    <span className=\"mr-1\">{icon}</span> {value}\r\n  </span>\r\n);\r\n\r\n// Main Map Component\r\nconst MapView = ({ rides }) => {\r\n  const defaultPosition = [51.505, -0.09];\r\n\r\n  const groupedRides = useMemo(() => {\r\n    if (!rides?.length) return [];\r\n\r\n    const tolerance = 0.001;\r\n    const groups = [];\r\n\r\n    rides.forEach((ride) => {\r\n      const match = groups.find((g) => {\r\n        const dx = g.lat - ride.location.lat;\r\n        const dy = g.lng - ride.location.lng;\r\n        return Math.sqrt(dx * dx + dy * dy) < tolerance;\r\n      });\r\n\r\n      if (match) {\r\n        match.rides.push(ride);\r\n      } else {\r\n        groups.push({\r\n          lat: ride.location.lat,\r\n          lng: ride.location.lng,\r\n          rides: [ride],\r\n        });\r\n      }\r\n    });\r\n\r\n    return groups;\r\n  }, [rides]);\r\n\r\n  const getMapCenter = () => {\r\n    if (!rides?.length) return defaultPosition;\r\n    if (rides.length === 1) return [rides[0].location.lat, rides[0].location.lng];\r\n\r\n    const avgLat = rides.reduce((sum, r) => sum + r.location.lat, 0) / rides.length;\r\n    const avgLng = rides.reduce((sum, r) => sum + r.location.lng, 0) / rides.length;\r\n    return [avgLat, avgLng];\r\n  };\r\n\r\n  const getMapZoom = () => (rides?.length === 1 ? 10 : 6);\r\n\r\n  return (\r\n    <div className=\"relative w-full h-full\">\r\n      <MapContainer\r\n        center={getMapCenter()}\r\n        zoom={getMapZoom()}\r\n        scrollWheelZoom\r\n        className=\"w-full h-full\"\r\n        style={{ height: \"100%\", width: \"100%\", zIndex: 1 }}\r\n      >\r\n        <TileLayer\r\n          attribution='&copy; <a href=\"https://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n        />\r\n        {groupedRides.map((group, i) => (\r\n          <Marker\r\n            key={`group-${i}`}\r\n            position={[group.lat, group.lng]}\r\n            icon={createBikeIcon(group.rides.length, group.rides.length > 1)}\r\n          >\r\n            <Popup maxWidth={400} className=\"custom-popup\">\r\n              <RidePopup rides={group.rides} />\r\n            </Popup>\r\n          </Marker>\r\n        ))}\r\n      </MapContainer>\r\n\r\n      {/* Map Legend */}\r\n      <div className=\"absolute bottom-4 left-4 bg-white p-3 rounded-lg shadow-lg z-10 text-xs\">\r\n        <h4 className=\"font-semibold mb-2\">Map Legend</h4>\r\n        <div className=\"space-y-1\">\r\n          <LegendItem color=\"bg-green-600\" label=\"Single ride\" icon=\"ðŸš´\" />\r\n          <LegendItem color=\"bg-blue-600\" label=\"Multiple rides\" number=\"3\" />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Summary */}\r\n      {rides?.length > 0 && (\r\n        <div className=\"absolute top-4 left-4 bg-white p-3 rounded-lg shadow-lg z-10 text-sm\">\r\n          <h4 className=\"font-semibold text-gray-900 mb-1\">Your Rides</h4>\r\n          <p className=\"text-gray-600\">\r\n            {rides.length} ride{rides.length > 1 ? \"s\" : \"\"} â€¢{\" \"}\r\n            {groupedRides.length} location{groupedRides.length > 1 ? \"s\" : \"\"}\r\n          </p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst LegendItem = ({ color, label, icon, number }) => (\r\n  <div className=\"flex items-center\">\r\n    <div\r\n      className={`w-5 h-5 ${color} rounded-full mr-2 flex items-center justify-center text-white text-xs`}\r\n    >\r\n      {icon || number}\r\n    </div>\r\n    <span>{label}</span>\r\n  </div>\r\n);\r\n\r\nexport default MapView;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}